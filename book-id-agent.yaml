agent:
  name: book_identifier_test
  description: "Identifies bibliographic facts, condition, and pricing guidance for eBay book listings."
  model:
    type: o3
    max_output_tokens: 2000
    reasoning:
      effort: medium
  system_prompt: |
    You are an experienced antiquarian bookseller preparing persuasive eBay listings from supplied book images and their public URLs.

    Responsibilities
    - Identify bibliographic facts: title, author, publication year, publisher & location, edition/printing, format/binding, notable features (illustrators, signatures, provenance, series), language, and other collector-relevant distinctions.
    - Assess physical condition using the AB Bookman hierarchy (As New, Fine, Near Fine, Very Good, Good, Fair, Poor). Inspect boards and spine, text block, dust jacket, edges, hinges, markings, completeness, and odor. Grade conservatively but highlight sale-worthy strengths to support strong pricing.
    - Map the observed grade to the correct eBay Condition ID:
      1000 New - unread, flawless.
      2750 Like New - looks new, read once at most, no wear.
      3000 Very Good - lightly used, minimal wear.
      5000 Good - noticeable wear yet sound, no missing pages.
      6000 Acceptable - well worn, readable, may have significant cosmetic flaws.
      Choose the closest code and mention key evidence in the condition notes.
    - Craft outputs that motivate confident purchase decisions:
      * blurb: 120-180 word sales copy summarising why the book is desirable.
      * condition: ABAA-style narrative covering boards/spine, pages/text block, dust jacket, hinges, edges, markings, odors, completeness.
      * details: collector highlights (edition points, inscriptions, provenance, rarity, market positioning).
      * price: USD float informed by comparable sales; justify premium when condition allows.
      * image_urls: pipe-delimited S3 URLs in listing order (primary photo first).
    - Use concise, professional tone. Surface defects candidly while emphasising preservation, originality, and collector appeal.

    Always return JSON that matches the declared schema.
  user_prompt: >
    Analyze the attached book images and follow the workflow to produce structured JSON for the listing.
  image_dir: batch-image-sets
  output_schema:
    type: object
    required:
      - title
      - author
      - blurb
      - condition
      - details
      - price
      - condition_id
      - image_urls
    properties:
      title:
        type: string
      author:
        type: string
      blurb:
        type: string
      condition:
        type: string
      details:
        type: string
      price:
        type: number
        format: float
      condition_id:
        type: string
        description: "One of: 1000, 2750, 3000, 5000, 6000."
      image_urls:
        type: string
        description: "Pipe-delimited list of HTTPS image URLs in display order."
      language:
        type: string
      publisher:
        type: string
      publication_year:
        type: string
      edition:
        type: string
  csv_output:
    enabled: true
    include_header: true
    columns:
      - "*Action(SiteID=US|Country=US|Currency=USD|Version=1193)"
      - "Category ID"
      - "Category name"
      - "Title"
      - "Start price"
      - "Quantity"
      - "Item photo URL"
      - "Condition ID"
      - "Description"
      - "Format"
      - "Duration"
      - "Location"
      - "Shipping profile name"
      - "Return profile name"
      - "Payment profile name"
      - "C:Author"
      - "C:Book Title"
      - "C:Language"
    defaults:
      "*Action(SiteID=US|Country=US|Currency=USD|Version=1193)": "Add"
      "Category ID": "261186"
      "Category name": "/Books & Magazines/Books"
      "Quantity": "1"
      "Format": "FixedPrice"
      "Duration": "GTC"
      "Location": "Newfields, NH"
      "Shipping profile name": "USPS Media Mail"
      "Return profile name": "Returns allowed within 30 days"
      "Payment profile name": "Immediate payment managed via eBay"
      "C:Language": "English"
    field_map:
      "Title": "{title}"
      "Start price": "{price}"
      "Item photo URL": "{image_urls}"
      "Condition ID": "{condition_id}"
      "Description": "{blurb}\n\nCondition Notes:\n{condition}\n\nCollector Details:\n{details}"
      "C:Author": "{author}"
      "C:Book Title": "{title}"
      "C:Language": "{language}"
